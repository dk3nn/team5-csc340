<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="home.css">
    <title>Auto-Pick Home</title>
</head>
<body>
    <div id="home-body">
        <div id="navbar">
            <h2 id="name">Auto-Pick</h2>
            <div id="navbar-links">
                <a href="home.html">Home</a>
                <a href="#">About</a>
                <a href="#">Contact</a>
            </div>
            <div id="btn-container">
                <button type="button" id="signup-btn">Sign Up</button>
                <button type="button" id="login-btn">LogIn</button>
            </div>
        </div>
        <div id="heading">
            <h1 style="text-align: center;">Welcome to Auto-Pick</h1>
            <p style="text-align: center;">Step to finding a new car</p>
            <div id="search">
                <input type="text" placeholder="Enter text here">
                <button id="search">Search</button>
            </div>
        </div>
        <div id="outer-container">
            <div id="car-listings">

            </div>
        </div>

        <div id="footer">
            <p>Copyright 2025</p>
        </div>
    </div>

    <script>
        const signUpButton = document.getElementById('signup-btn');
        const loginButton = document.getElementById('login-btn');

        signUpButton.addEventListener('click', () => {
            window.location.href = 'signup.html';
        });
        loginButton.addEventListener('click', () => {
            window.location.href = 'provider/login.html';
        });


    container = document.getElementById('car-listings')
    fetch('http://localhost:8080/api/vehicles/unsold')
        .then(response => response.json())
        .then(data => {
            populateCars(data);
        })
        .catch(error => {
            console.error('Error fetching car data:', error);
        });

    const searchButton = document.getElementById('search');
    searchButton.addEventListener('click', () => {
        const searchInput = document.querySelector('#search input').value;
        fetch('http://localhost:8080/api/vehicles/unsold/search?make=' + encodeURIComponent(searchInput))
            .then(response => response.json())
            .then(data => {
                container.innerHTML = '';
                populateCars(data);
            })
            .catch(error => {
                console.error('Error fetching search results:', error);
            });
    });

    function populateCars(carInventory) {

        carInventory.forEach(car => { 
                const card = document.createElement('div');
                card.className = 'car-card';

                const img = document.createElement('img');
                img.src = car.imageUrl;
                img.alt = name

                const cardTextArea = document.createElement('div')
                cardTextArea.className = "card-text-area"

                const cardHeading = document.createElement('h3');
                cardHeading.textContent = car.make + " " + car.model + " " + car.trim +" " + car.year;

                const carMilage = document.createElement('p');
                carMilage.innerHTML = "<strong>Milage: </strong>" + car.mileage;

                const carEngineType = document.createElement('p');
                carEngineType.innerHTML = "<strong>Engine Size: </strong>" + car.engineSize;

                const carPrice = document.createElement('p');
                carPrice.innerHTML = "<strong>Price: </strong>$" + car.price;

                const carDealer = document.createElement('p');
                carDealer.innerHTML = "<strong>Dealer: </strong><a href='review.html?id=" + car.dealer.id + "'>" + car.dealer.name + "</a>";

                const btnContainer = document.createElement('div')
                btnContainer.className = 'card-btn-container'


                const detailButton = document.createElement('button');
                detailButton.textContent = "View Details";
                detailButton.type ="button";
                detailButton.onclick = function() {
                    window.location.href = '/vehicles/' + car.id;
                };

                btnContainer.append(detailButton);

                container.appendChild(card);
                card.appendChild(img);
                card.appendChild(cardTextArea);
                cardTextArea.appendChild(cardHeading);
                cardTextArea.appendChild(carMilage);
                cardTextArea.appendChild(carEngineType);
                cardTextArea.appendChild(carPrice);
                cardTextArea.appendChild(carDealer);
                card.appendChild(btnContainer);

            });
    }
  </script>
</body>
</html>